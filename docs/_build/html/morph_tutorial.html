

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Table morph tutorial &mdash; whyqd 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distribution &amp; Citation of methods and data" href="citation.html" />
    <link rel="prev" title="Full worked tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> whyqd
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Dependencies, installation &amp; importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Full worked tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Table morph tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-schema">Creating a Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="#morphing-with-methods">Morphing with Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Distribution &amp; Citation of methods and data</a></li>
</ul>
<p class="caption"><span class="caption-text">Creating and managing Schemas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Schema</a></li>
</ul>
<p class="caption"><span class="caption-text">Wrangling with Methods</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="method.html">Method</a></li>
</ul>
<p class="caption"><span class="caption-text">What next?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Background and Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="field_api.html">Field</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema_api.html">Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_api.html">Action</a></li>
<li class="toctree-l1"><a class="reference internal" href="morph_api.html">Morph</a></li>
<li class="toctree-l1"><a class="reference internal" href="method_api.html">Method</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">whyqd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Table morph tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/morph_tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="table-morph-tutorial">
<h1>Table morph tutorial<a class="headerlink" href="#table-morph-tutorial" title="Permalink to this headline">¶</a></h1>
<p>For years I’ve taught an introductory <a class="reference external" href="https://github.com/whythawk/data-wrangling-and-validation">Data wrangling &amp; validation</a>
course using the same training data-series: the Human Development Index report of 2007 - 2008
released by the UNDP as part of the Millennial Development Goals.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In 1990 the first <a class="reference external" href="http://www.hdr.undp.org/">Human Development Report</a> introduced a new
approach for advancing human wellbeing. Human development – or the human development approach - is
about expanding the richness of human life, rather than simply the richness of the economy in which
human beings live. It is an approach that is focused on people and their opportunities and choices.</p>
</div>
<p>These days it’s a slick affair with beautifully-prepared open data in a standardised format. Back then
it was a constantly-changing mess of non-standard Excel spreadsheets.</p>
<div class="figure align-default" id="id2">
<img alt="UNDP Human Development Index 2007-2008" src="_images/undp-hdi-2007-8.jpg" />
<p class="caption"><span class="caption-text">UNDP Human Development Index 2007-2008: a beautiful example of messy data.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>Teaching open data managers in countries around the world the importance of open standards and well-structured
machine-readable data is brought home when seeing this and experiencing how difficult it is to work with.</p>
<p>I never really expected to fix this sort of thing programmatically. However, with a little creativity,
it turns out you can.</p>
<div class="section" id="creating-a-schema">
<h2>Creating a Schema<a class="headerlink" href="#creating-a-schema" title="Permalink to this headline">¶</a></h2>
<p>The 2007-8 HDI report was listed as a series of about 50 spreadsheets, each dataset aligned with the
objectives of the <a class="reference external" href="https://www.un.org/millenniumgoals/">Millennium Development Goals</a>. These supporting
information were used to track countries meeting the MDG targets. Analysis required rebuilding these
spreadsheets into a single database aligned to a common schema.</p>
<p>This tutorial assumes you have already completed <a class="reference internal" href="tutorial.html"><span class="doc">Full worked tutorial</span></a> or are familiar with the concepts used
in <strong>whyqd</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">whyqd</span> <span class="k">as</span> <span class="nn">_w</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">_w</span><span class="o">.</span><span class="n">Schema</span><span class="p">()</span>
<span class="n">details</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;human-development-report&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;UN Human Development Report 2007 - 2008&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        In 1990 the first Human Development Report introduced a new approach for</span>
<span class="s2">        advancing human wellbeing. Human development – or the human development approach - is about</span>
<span class="s2">        expanding the richness of human life, rather than simply the richness of the economy in which</span>
<span class="s2">        human beings live. It is an approach that is focused on people and their opportunities and choices.&quot;&quot;&quot;</span>
<span class="p">}</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">_w</span><span class="o">.</span><span class="n">Schema</span><span class="p">()</span>
<span class="n">schema</span><span class="o">.</span><span class="n">set_details</span><span class="p">(</span><span class="o">**</span><span class="n">details</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s define the fields in our schema and then iterate over the list to add each field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Country Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Country Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Official country names.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;constraints&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Indicator Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Indicator Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Indicator described in the data series.&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Reference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Reference&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Reference to data source.&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Year of release.&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Value for the Year and Indicator Name.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;constraints&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
    <span class="n">schema</span><span class="o">.</span><span class="n">set_field</span><span class="p">(</span><span class="o">**</span><span class="n">field</span><span class="p">)</span>
</pre></div>
</div>
<p>We can save our schema to a specified <cite>directory</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="s2">&quot;/path/to/directory&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;human-development-report-schema&quot;</span>
<span class="n">schema</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>So far, so straightforward. Now to the wrangling.</p>
</div>
<div class="section" id="morphing-with-methods">
<h2>Morphing with Methods<a class="headerlink" href="#morphing-with-methods" title="Permalink to this headline">¶</a></h2>
<p>Any data series consists of numerical values (usually) described by standardised metadata terms
(time, area, a specific description, etc). There are two main ways of presenting these machine-readable
data, which can be summarised as wide or long. You need to make a deliberate choice as to which format
you will choose, and each has its own particular strengths and weaknesses:</p>
<p><strong>Wide data</strong> present numerical data in multiple columns. Either as categories (e.g. each country is
presented in its own column) or by date (e.g. each annual update results in a new column). New data
go across the screen from left to right.</p>
<p>Wide data are often used for data visualisation and processing since the data can easily be grouped
into the necessary axes for chart libraries. However, it’s a difficult archival format since updating
such a dataseries requires the equivalent of creating a new field (the year in the fields above) and
then updating every row with appropriate information. That can be an expensive operation in a large
database, and also means that writing a programmatic method for querying your data is more challenging.</p>
<p><strong>Long data</strong> present numerical data in multiple rows with only one column for values. New data go
down the screen from top to bottom. These were the sort of data we used in the first tutorial.</p>
<p>Long data are best for archival and for representing the structure you will ordinarily find in a
database. Each row in a long dataseries represents a row in a database. Adding new information is
relatively straightforward since you only need update a single row at a time. In database terms,
you’d be creating a single database entry.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The preference in open data publication is for the long format, and this will be the
method usually recommended for release. That said, conversion between them - as long as data
are machine-readable with well-defined metadata - is straightforward.</p>
</div>
<p>Our tutorial data are wide, and horrifically malformed:</p>
<ul class="simple">
<li><p>Merged headers, and a header row smeared across multiple rows which doesn’t start at the top</p></li>
<li><p>References scattered throughout data</p></li>
<li><p>Aggregations which can safely be left out</p></li>
<li><p>Blank columns and rows, and redundant information</p></li>
</ul>
<p>The <a class="reference internal" href="morph_api.html"><span class="doc">Morph</span></a> class offers a set of tools for manipulating and restructuring these data, while
also adding a record of these transactions into the <a class="reference internal" href="method.html"><span class="doc">Method</span></a>. In this tutorial, we’re focused
on the morph component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;pre { white-space: pre !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">whyqd</span> <span class="k">as</span> <span class="nn">_w</span>

<span class="n">SCHEMA_SOURCE</span> <span class="o">=</span> <span class="s2">&quot;/full/path_to/human-development-report-schema.json&quot;</span>
<span class="n">DIRECTORY</span> <span class="o">=</span> <span class="s2">&quot;/path_to/working/directory/&quot;</span>
<span class="n">INPUT_DATA</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;HDR 2007-2008 Table 03.xlsx&quot;</span>
<span class="p">]</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">_w</span><span class="o">.</span><span class="n">Method</span><span class="p">(</span><span class="n">SCHEMA_SOURCE</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">DIRECTORY</span><span class="p">,</span> <span class="n">input_data</span><span class="o">=</span><span class="n">INPUT_DATA</span><span class="p">)</span>
</pre></div>
</div>
<p>You can collect any sample data from the <a class="reference external" href="https://github.com/whythawk/data-wrangling-and-validation">Data wrangling &amp; validation</a>
course. The <a class="reference external" href="https://github.com/whythawk/data-wrangling-and-validation/tree/master/data/lesson-spreadsheet">sample data folder</a>
contains a selection of files you can use. This tutorial uses <cite>HDR 2007-2008 Table 03.xlsx</cite>.</p>
<p>When you get help on the next step, you’ll see a problem:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">print_input_data</span><span class="p">())</span>

<span class="n">Data</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="n">aff74e7</span><span class="o">-</span><span class="mi">8115</span><span class="o">-</span><span class="mi">42</span><span class="n">d0</span><span class="o">-</span><span class="n">bf00</span><span class="o">-</span><span class="mf">4660966e0</span><span class="n">a52</span>
<span class="n">Original</span> <span class="n">source</span><span class="p">:</span> <span class="n">HDR</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">2008</span> <span class="n">Table</span> <span class="mf">03.</span><span class="n">xlsx</span>

<span class="o">====</span>  <span class="o">===============================================</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============================================================</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>
<span class="o">..</span>  <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">0</span>                                         <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">1</span>    <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">2</span>    <span class="n">Monitoring</span> <span class="n">human</span> <span class="n">development</span><span class="p">:</span> <span class="n">enlarging</span> <span class="n">people</span><span class="s1">&#39;s choices …    Unnamed: 4    Unnamed: 5    Unnamed: 6    Unnamed: 7    Unnamed: 8    Unnamed: 9    Unnamed: 10    Unnamed: 11    Unnamed: 12    Unnamed: 13    Unnamed: 14    Unnamed: 15    Unnamed: 16    Unnamed: 17    Unnamed: 18    Unnamed: 19    Unnamed: 20    Unnamed: 21    Unnamed: 22    Unnamed: 23    Unnamed: 24    Unnamed: 25    Unnamed: 26    Unnamed: 27    Unnamed: 28    Unnamed: 29    Unnamed: 30</span>
<span class="o">====</span>  <span class="o">===============================================</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============================================================</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>
<span class="mi">0</span>  <span class="mi">3</span> <span class="n">Human</span> <span class="ow">and</span> <span class="n">income</span> <span class="n">poverty</span> <span class="n">Developing</span> <span class="n">countries</span>           <span class="n">nan</span>           <span class="n">nan</span>                                                           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>
<span class="mi">1</span>  <span class="n">nan</span>                                                       <span class="n">nan</span>           <span class="n">nan</span>                                                           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>
<span class="mi">2</span>  <span class="n">nan</span>                                                       <span class="n">nan</span>           <span class="n">nan</span>                                                           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>           <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>            <span class="n">nan</span>
<span class="o">====</span>  <span class="o">===============================================</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============================================================</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>  <span class="o">=============</span>
</pre></div>
</div>
<p>There doesn’t seem to be any data. At this stage you may be tempted to start hacking at the file
directly and see what you can fix, but our objective is not only clean data, but also an auditable
record of how you went from source to final that can demonstrate the decisions you made, and
whether you were able to maintain all the source data.</p>
<p><strong>Whyqd</strong> offers a set of morphs that permit you to restructure individual tables prior to merging.
As with <a class="reference internal" href="action_api.html"><span class="doc">Action</span></a>, you can list the available morphs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">method</span><span class="o">.</span><span class="n">default_morph_types</span>

<span class="p">[</span><span class="s1">&#39;CATEGORISE&#39;</span><span class="p">,</span> <span class="s1">&#39;DEBLANK&#39;</span><span class="p">,</span> <span class="s1">&#39;DEDUPE&#39;</span><span class="p">,</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="s1">&#39;MELT&#39;</span><span class="p">,</span> <span class="s1">&#39;REBASE&#39;</span><span class="p">,</span> <span class="s1">&#39;RENAME&#39;</span><span class="p">]</span>

<span class="c1"># As an example:</span>
<span class="n">method</span><span class="o">.</span><span class="n">default_morph_settings</span><span class="p">(</span><span class="s2">&quot;CATEGORISE&quot;</span><span class="p">)</span>

<span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CATEGORISE&#39;</span><span class="p">,</span>
<span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Categorise&#39;</span><span class="p">,</span>
<span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;morph&#39;</span><span class="p">,</span>
<span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Convert row-level categories into column categorisations.&#39;</span><span class="p">,</span>
<span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rows&#39;</span><span class="p">,</span> <span class="s1">&#39;column_names&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<p>Similarly to an Action, the standard way of writing a morph is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;MORPH_NAME&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">rows</span><span class="p">],</span> <span class="p">[</span><span class="n">columns</span><span class="p">],</span> <span class="p">[</span><span class="n">column_names</span><span class="p">]]</span>
</pre></div>
</div>
<p>The presence of the parameters - <cite>rows</cite>, <cite>columns</cite>, <cite>column_names</cite> - is specified in the <cite>structure</cite>
of the morph type.</p>
<ul class="simple">
<li><p><cite>rows</cite>: address the row number of the table. These will remain immutable, so the row number is the row number.</p></li>
<li><p><cite>columns</cite>: these are the actual column names at that point of the morph. There <strong>are</strong> mutable and change as you morph.</p></li>
<li><p><cite>column_names</cite>: these are optional, but you can provide root names that will be used in creating new columns.</p></li>
</ul>
<p>When you add your first morph, <strong>whyqd</strong> will automatically add in <cite>DEBLANK</cite> and <cite>DEDUPE</cite>. Figuring
out the exact order of the morphs is trial-and-error, but nothing is committed and you can undo and redo
as you require.</p>
<p>A few tools to help you … <cite>input_dataframe(id)</cite> returns the complete <cite>pandas</cite> dataframe for your
source data. It will also run all of the morphas up to that point, allowing you to see the impact of
your morph order. You can then explore our data and figure out what we need to do next:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># We only have one input_data source file</span>
<span class="n">_id</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">input_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">input_dataframe</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
</pre></div>
</div>
<p>If you get to a point where you’re tangled entirely, <cite>reset_input_data_morph(id)</cite> will remove all the
morphs and let you start again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">method</span><span class="o">.</span><span class="n">reset_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
</pre></div>
</div>
<p>I encourage you to explore this dataset and see exactly the decisions made, but here’s my approach:</p>
<ul>
<li><p>Let’s rebase the table to the top of the actual data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;REBASE&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>We can get rid of rows below <cite>144</cite> to the end of the table. These contain metadata that you may want
to keep and publish separately:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">144</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Now lets name the columns that remain based on what their original names. Also note that the
reference columns were previously unlabeled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;HDI rank&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Country&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Human poverty index (HPI-1) - Rank&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Human poverty index (HPI-1) - Value (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Probability at birth of not surviving to age 40 (</span><span class="si">% o</span><span class="s2">f cohort) 2000-05&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Adult illiteracy rate (</span><span class="si">% a</span><span class="s2">ged 15 and older) 1995-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population not using an improved water source (%) 2004&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Children under weight for age (</span><span class="si">% u</span><span class="s2">nder age 5) 1996-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population below income poverty line (%) - $1 a day 1990-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population below income poverty line (%) - $2 a day 1990-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population below income poverty line (%) - National poverty line 1990-2004&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HPI-1 rank minus income poverty rank&quot;</span>
<span class="p">]</span>
<span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;RENAME&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>If you look through the data, you’ll see that there are rows that define categories for data that
appear below it. Here <cite>HIGH HUMAN DEVELOPMENT</cite> is an <cite>HDI Category</cite> and all the rows between this row
and the next category <cite>MEDIUM HUMAN DEVELOPMENT</cite> form part of that category. What we need to do is
“rotate” these rows into a column and assign the category to the effected data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">120</span><span class="p">]</span> <span class="c1"># These contain the categorical data</span>
<span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;CATEGORISE&quot;</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="s2">&quot;HDI category&quot;</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Most of these columns are actually indicators and can be pivoted into an <cite>Indicator</cite> column with
the <cite>Values</cite> assigned into a single column. This is called a <cite>MELT</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select all the columns to be melted</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;HDI rank&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HDI category&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Human poverty index (HPI-1) - Rank&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Human poverty index (HPI-1) - Value (%)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Probability at birth of not surviving to age 40 (</span><span class="si">% o</span><span class="s2">f cohort) 2000-05&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Adult illiteracy rate (</span><span class="si">% a</span><span class="s2">ged 15 and older) 1995-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population not using an improved water source (%) 2004&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Children under weight for age (</span><span class="si">% u</span><span class="s2">nder age 5) 1996-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population below income poverty line (%) - $1 a day 1990-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population below income poverty line (%) - $2 a day 1990-2005&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population below income poverty line (%) - National poverty line 1990-2004&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HPI-1 rank minus income poverty rank&quot;</span>
<span class="p">]</span>
<span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;MELT&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Indicator Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Indicator Value&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</li>
<li><p>Similarly, the <cite>References</cite> can be pivoted into a separate column as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Reference 1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reference 8&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;MELT&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Reference Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Reference&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</li>
<li><p>Let’s add in a final <cite>DEBLANK</cite> just to be sure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">method</span><span class="o">.</span><span class="n">add_input_data_morph</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DEBLANK&quot;</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ul>
<p>Get the current implementation of the morphs and have a look:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">input_dataframe</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 26%" />
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 19%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Country</p></th>
<th class="head"><p>Indicator Name</p></th>
<th class="head"><p>Indicator Value</p></th>
<th class="head"><p>Reference Name</p></th>
<th class="head"><p>Reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Hong Kong, China (SAR)</p></td>
<td><p>HDI rank</p></td>
<td><p>21</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Singapore</p></td>
<td><p>HDI rank</p></td>
<td><p>25</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Korea (Republic of)</p></td>
<td><p>HDI rank</p></td>
<td><p>26</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Cyprus</p></td>
<td><p>HDI rank</p></td>
<td><p>28</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Brunei Darussalam</p></td>
<td><p>HDI rank</p></td>
<td><p>30</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
</tbody>
</table>
<p>Cool, huh? Let’s quickly finish up the <cite>method</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">method</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">overwrite_working</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="s2">&quot;structure&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><cite>structure</cite> is the core of the wrangling process and is the process where you define the actions
which must be performed to restructure your working data.</p>
<p>Create a list of methods of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="s2">&quot;schema_field1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="s2">&quot;column_name1&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="s2">&quot;column_name2&quot;</span><span class="p">]],</span>
        <span class="s2">&quot;schema_field2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="s2">&quot;column_name1&quot;</span><span class="p">,</span> <span class="s2">&quot;modifier&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="s2">&quot;column_name2&quot;</span><span class="p">]],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The format for defining a <cite>structure</cite> is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">action</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="p">[</span><span class="n">action</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]]</span>
</pre></div>
</div>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;CATEGORISE&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ORDER&quot;</span><span class="p">,</span> <span class="s2">&quot;column_1&quot;</span><span class="p">,</span> <span class="s2">&quot;column_2&quot;</span><span class="p">]]</span>
</pre></div>
</div>
<p>This permits the creation of quite expressive wrangling structures from simple building
blocks.</p>
<p>The schema for this method consists of the following terms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;country_name&#39;</span><span class="p">,</span> <span class="s1">&#39;indicator_name&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The actions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;CALCULATE&#39;</span><span class="p">,</span> <span class="s1">&#39;CATEGORISE&#39;</span><span class="p">,</span> <span class="s1">&#39;JOIN&#39;</span><span class="p">,</span> <span class="s1">&#39;NEW&#39;</span><span class="p">,</span> <span class="s1">&#39;ORDER&#39;</span><span class="p">,</span> <span class="s1">&#39;ORDER_NEW&#39;</span><span class="p">,</span> <span class="s1">&#39;ORDER_OLD&#39;</span><span class="p">,</span> <span class="s1">&#39;RENAME&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The columns from your working data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Indicator Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Indicator Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Reference Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Reference&#39;</span><span class="p">]</span>

<span class="n">Data</span> <span class="nb">id</span><span class="p">:</span> <span class="n">working_21ebcf74</span><span class="o">-</span><span class="n">e6ab</span><span class="o">-</span><span class="mi">4</span><span class="n">a19</span><span class="o">-</span><span class="n">bd9a</span><span class="o">-</span><span class="n">d1a072ed96a2</span>
<span class="n">Original</span> <span class="n">source</span><span class="p">:</span> <span class="n">method</span><span class="o">.</span><span class="n">input_data</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 26%" />
<col style="width: 20%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Country</p></th>
<th class="head"><p>Indicator Value</p></th>
<th class="head"><p>Indicator Name</p></th>
<th class="head"><p>Reference Name</p></th>
<th class="head"><p>Reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Hong Kong, China (SAR)</p></td>
<td><p>21</p></td>
<td><p>HDI rank</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Singapore</p></td>
<td><p>25</p></td>
<td><p>HDI rank</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Korea (Republic of)</p></td>
<td><p>26</p></td>
<td><p>HDI rank</p></td>
<td><p>Reference 1</p></td>
<td><p>nan</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>Current method status: <cite>Ready to Structure</cite></p>
</div></blockquote>
<p>And:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">structure</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;country_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RENAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Country&quot;</span><span class="p">],</span>
    <span class="s2">&quot;indicator_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RENAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Indicator Name&quot;</span><span class="p">],</span>
    <span class="s2">&quot;reference&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RENAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Reference&quot;</span><span class="p">],</span>
    <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RENAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Indicator Value&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">method</span><span class="o">.</span><span class="n">set_structure</span><span class="p">(</span><span class="o">**</span><span class="n">structure</span><span class="p">)</span>
<span class="n">method</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">overwrite_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">FILENAME</span> <span class="o">=</span> <span class="s2">&quot;hdi_report_exercise&quot;</span>
<span class="n">method</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">FILENAME</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Concluding the morphs tutorial.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="citation.html" class="btn btn-neutral float-right" title="Distribution &amp; Citation of methods and data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Full worked tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Gavin Chait

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>